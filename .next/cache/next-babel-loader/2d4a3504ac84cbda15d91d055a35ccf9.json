{"ast":null,"code":"const InfoAPI = () => null;\n\nInfoAPI.getInitialProps = async ({\n  req,\n  res\n}) => {\n  res.setHeader('Content-Type', 'application/json');\n\n  try {\n    const ip = req.headers['x-forwarded-for'] || req.connection.remoteAddress;\n    if (!ip) throw new Error('API error');\n    const response = await fetch(`https://freegeoip.app/json/${ip}`, {\n      method: 'get',\n      headers: {\n        accept: 'application/json' // 'x-auth-token': apiKey,\n\n      }\n    });\n    if (!response.ok) throw new Error('API error');\n    const data = await response.json();\n    res.json(data);\n    res.end();\n  } catch (error) {\n    res.write(JSON.stringify({\n      message: error\n    }));\n    res.end();\n  }\n};\n\nexport default InfoAPI;","map":{"version":3,"sources":["/Users/paulvandyk/Projects/Kenai/ipinfo/pages/index.tsx"],"names":["InfoAPI","getInitialProps","req","res","setHeader","ip","headers","connection","remoteAddress","Error","response","fetch","method","accept","ok","data","json","end","error","write","JSON","stringify","message"],"mappings":"AAEA,MAAMA,OAAiB,GAAG,MAAM,IAAhC;;AAMAA,OAAO,CAACC,eAAR,GAA0B,OAAO;AAAEC,EAAAA,GAAF;AAAOC,EAAAA;AAAP,CAAP,KAAqC;AAC7DA,EAAAA,GAAG,CAACC,SAAJ,CAAc,cAAd,EAA8B,kBAA9B;;AACA,MAAI;AACF,UAAMC,EAAE,GAAGH,GAAG,CAACI,OAAJ,CAAY,iBAAZ,KAAkCJ,GAAG,CAACK,UAAJ,CAAeC,aAA5D;AACA,QAAI,CAACH,EAAL,EAAS,MAAM,IAAII,KAAJ,CAAU,WAAV,CAAN;AACT,UAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAE,8BAA6BN,EAAG,EAAlC,EAAqC;AAC/DO,MAAAA,MAAM,EAAE,KADuD;AAE/DN,MAAAA,OAAO,EAAE;AACPO,QAAAA,MAAM,EAAE,kBADD,CAEP;;AAFO;AAFsD,KAArC,CAA5B;AAOA,QAAI,CAACH,QAAQ,CAACI,EAAd,EAAkB,MAAM,IAAIL,KAAJ,CAAU,WAAV,CAAN;AAClB,UAAMM,IAAI,GAAG,MAAML,QAAQ,CAACM,IAAT,EAAnB;AAEAb,IAAAA,GAAG,CAACa,IAAJ,CAASD,IAAT;AACAZ,IAAAA,GAAG,CAACc,GAAJ;AACD,GAfD,CAeE,OAAOC,KAAP,EAAc;AACdf,IAAAA,GAAG,CAACgB,KAAJ,CAAUC,IAAI,CAACC,SAAL,CAAe;AAAEC,MAAAA,OAAO,EAAEJ;AAAX,KAAf,CAAV;AACAf,IAAAA,GAAG,CAACc,GAAJ;AACD;AACF,CArBD;;AAuBA,eAAejB,OAAf","sourcesContent":["import { NextPage, NextPageContext, NextApiRequest, NextApiResponse } from 'next'\n\nconst InfoAPI: NextPage = () => null\ninterface PageContext extends NextPageContext {\n  req: NextApiRequest\n  res: NextApiResponse\n}\n\nInfoAPI.getInitialProps = async ({ req, res }: PageContext) => {\n  res.setHeader('Content-Type', 'application/json')\n  try {\n    const ip = req.headers['x-forwarded-for'] || req.connection.remoteAddress\n    if (!ip) throw new Error('API error')\n    const response = await fetch(`https://freegeoip.app/json/${ip}`, {\n      method: 'get',\n      headers: {\n        accept: 'application/json',\n        // 'x-auth-token': apiKey,\n      },\n    })\n    if (!response.ok) throw new Error('API error')\n    const data = await response.json()\n\n    res.json(data)\n    res.end()\n  } catch (error) {\n    res.write(JSON.stringify({ message: error }))\n    res.end()\n  }\n}\n\nexport default InfoAPI\n"]},"metadata":{},"sourceType":"module"}