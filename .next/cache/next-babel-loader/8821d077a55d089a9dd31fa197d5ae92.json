{"ast":null,"code":"import fetch from 'isomorphic-unfetch';\nconst apiKey = 'e4bd1590-a940-47b3-b705-91ea25395c14';\n\nfunction validIP(ip) {\n  const ipArr = ip.split('.');\n  let valid = true;\n  if (ipArr.length !== 4) return false;\n  ipArr.forEach(item => {\n    const itemNum = parseInt(item);\n    if (!itemNum) valid = false;else if (itemNum < 0 || itemNum > 255) valid = false;\n  });\n  return valid;\n}\n\nexport default (async (req, res) => {\n  try {\n    const ip = req.query.ip;\n    if (!ip || !validIP(ip)) throw new Error('Invalid ip address');\n    const response = await fetch(`https://signals.api.auth0.com/v2.0/ip/${ip}`, {\n      method: 'get',\n      headers: {\n        'X-Auth-Token': apiKey\n      }\n    });\n    const data = await response.json();\n    return res.status(200).json(data.fullip);\n  } catch (error) {\n    console.log(error);\n    return res.status(401).json({\n      message: error.message\n    });\n  }\n});","map":{"version":3,"sources":["/Users/paulvandyk/Projects/Kenai/ipinfo/pages/api/[ip].ts"],"names":["fetch","apiKey","validIP","ip","ipArr","split","valid","length","forEach","item","itemNum","parseInt","req","res","query","Error","response","method","headers","data","json","status","fullip","error","console","log","message"],"mappings":"AACA,OAAOA,KAAP,MAAkB,oBAAlB;AAEA,MAAMC,MAAM,GAAG,sCAAf;;AAEA,SAASC,OAAT,CAAiBC,EAAjB,EAA6B;AAC3B,QAAMC,KAAK,GAAGD,EAAE,CAACE,KAAH,CAAS,GAAT,CAAd;AACA,MAAIC,KAAK,GAAG,IAAZ;AACA,MAAIF,KAAK,CAACG,MAAN,KAAiB,CAArB,EAAwB,OAAO,KAAP;AACxBH,EAAAA,KAAK,CAACI,OAAN,CAAeC,IAAD,IAAU;AACtB,UAAMC,OAAO,GAAGC,QAAQ,CAACF,IAAD,CAAxB;AACA,QAAI,CAACC,OAAL,EAAcJ,KAAK,GAAG,KAAR,CAAd,KACK,IAAII,OAAO,GAAG,CAAV,IAAeA,OAAO,GAAG,GAA7B,EAAkCJ,KAAK,GAAG,KAAR;AACxC,GAJD;AAKA,SAAOA,KAAP;AACD;;AAED,gBAAe,OAAOM,GAAP,EAA4BC,GAA5B,KAAqD;AAClE,MAAI;AACF,UAAMV,EAAE,GAAGS,GAAG,CAACE,KAAJ,CAAUX,EAArB;AAEA,QAAI,CAACA,EAAD,IAAO,CAACD,OAAO,CAACC,EAAD,CAAnB,EAAyB,MAAM,IAAIY,KAAJ,CAAU,oBAAV,CAAN;AACzB,UAAMC,QAAQ,GAAG,MAAMhB,KAAK,CAAE,yCAAwCG,EAAG,EAA7C,EAAgD;AAC1Ec,MAAAA,MAAM,EAAE,KADkE;AAE1EC,MAAAA,OAAO,EAAE;AAAE,wBAAgBjB;AAAlB;AAFiE,KAAhD,CAA5B;AAIA,UAAMkB,IAAI,GAAG,MAAMH,QAAQ,CAACI,IAAT,EAAnB;AACA,WAAOP,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBD,IAAhB,CAAqBD,IAAI,CAACG,MAA1B,CAAP;AACD,GAVD,CAUE,OAAOC,KAAP,EAAc;AACdC,IAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACA,WAAOV,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBD,IAAhB,CAAqB;AAAEM,MAAAA,OAAO,EAAEH,KAAK,CAACG;AAAjB,KAArB,CAAP;AACD;AACF,CAfD","sourcesContent":["import { NextApiRequest, NextApiResponse } from 'next'\nimport fetch from 'isomorphic-unfetch'\n\nconst apiKey = 'e4bd1590-a940-47b3-b705-91ea25395c14'\n\nfunction validIP(ip: string) {\n  const ipArr = ip.split('.')\n  let valid = true\n  if (ipArr.length !== 4) return false\n  ipArr.forEach((item) => {\n    const itemNum = parseInt(item)\n    if (!itemNum) valid = false\n    else if (itemNum < 0 || itemNum > 255) valid = false\n  })\n  return valid\n}\n\nexport default async (req: NextApiRequest, res: NextApiResponse) => {\n  try {\n    const ip = req.query.ip as string\n\n    if (!ip || !validIP(ip)) throw new Error('Invalid ip address')\n    const response = await fetch(`https://signals.api.auth0.com/v2.0/ip/${ip}`, {\n      method: 'get',\n      headers: { 'X-Auth-Token': apiKey },\n    })\n    const data = await response.json()\n    return res.status(200).json(data.fullip)\n  } catch (error) {\n    console.log(error)\n    return res.status(401).json({ message: error.message })\n  }\n}\n"]},"metadata":{},"sourceType":"module"}